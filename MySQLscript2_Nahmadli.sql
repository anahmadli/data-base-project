
DROP DATABASE IF EXISTS HAPPY_LEARNING_AN;
CREATE DATABASE HAPPY_LEARNING_AN;

USE HAPPY_LEARNING_AN;

SHOW DATABASES;


SHOW TABLES;

CREATE TABLE TEACHER_AN (
    TEACHER_ID_AN  INT          PRIMARY KEY,
    FIRST_NAME_AN  VARCHAR(30)  NOT NULL,
    LAST_NAME_AN   VARCHAR(30)  NOT NULL,
    PHONE_AN       VARCHAR(15)  NOT NULL
);

CREATE TABLE CLASS_AN (
    CLASS_CODE_AN  CHAR(2)      PRIMARY KEY,
    LEVEL_AN       VARCHAR(10)  NOT NULL,
    COLOR_AN       VARCHAR(10)  NOT NULL,
    DIRECTIONS_AN  VARCHAR(100) NOT NULL,
    TEACHER_ID_AN  INT          NOT NULL,
    CONSTRAINT FK_CLASS_TEACHER_AN
        FOREIGN KEY (TEACHER_ID_AN)
        REFERENCES TEACHER_AN(TEACHER_ID_AN)
);

CREATE TABLE STUDENT_AN (
    STUDENT_ID_AN    INT          PRIMARY KEY,
    FIRST_NAME_AN    VARCHAR(30)  NOT NULL,
    LAST_NAME_AN     VARCHAR(30)  NOT NULL,
    DATE_OF_BIRTH_AN DATE         NOT NULL,
    ZIPCODE_AN       CHAR(10)     NOT NULL,
    CLASS_CODE_AN    CHAR(2)      NOT NULL,
    CONSTRAINT FK_STUDENT_CLASS_AN
        FOREIGN KEY (CLASS_CODE_AN)
        REFERENCES CLASS_AN(CLASS_CODE_AN)
);

CREATE TABLE CARETAKER_AN (
    CARETAKER_ID_AN  INT          PRIMARY KEY,
    FIRST_NAME_AN    VARCHAR(30)  NOT NULL,
    LAST_NAME_AN     VARCHAR(30)  NOT NULL,
    WORK_PHONE_AN    VARCHAR(15)  NOT NULL
);

CREATE TABLE ASSIGNMENT_AN (
    STUDENT_ID_AN    INT          NOT NULL,
    CARETAKER_ID_AN  INT          NOT NULL,
    RELATIONSHIP_AN  VARCHAR(20)  NOT NULL,
    PRIMARY KEY (STUDENT_ID_AN, CARETAKER_ID_AN),
    CONSTRAINT FK_ASSIGN_STUDENT_AN
        FOREIGN KEY (STUDENT_ID_AN)
        REFERENCES STUDENT_AN(STUDENT_ID_AN),
    CONSTRAINT FK_ASSIGN_CARETAKER_AN
        FOREIGN KEY (CARETaker_ID_AN)
        REFERENCES CARETaker_AN(CARETaker_ID_AN)
);

SHOW TABLES;

-- Show structures
DESCRIBE TEACHER_AN;
DESCRIBE CLASS_AN;
DESCRIBE STUDENT_AN;
DESCRIBE CARETAKER_AN;
DESCRIBE ASSIGNMENT_AN;


SELECT * FROM TEACHER_AN;
SELECT * FROM CLASS_AN;
SELECT * FROM STUDENT_AN;
SELECT * FROM CARETAKER_AN;
SELECT * FROM ASSIGNMENT_AN;

INSERT INTO TEACHER_AN (TEACHER_ID_AN, FIRST_NAME_AN, LAST_NAME_AN, PHONE_AN) VALUES
(1, 'Emily',  'Smith',   '703-111-0001'),
(2, 'David',  'Brown',   '703-111-0002'),
(3, 'Sarah',  'Johnson', '703-111-0003'),
(4, 'Mark',   'Wilson',  '703-111-0004'),
(5, 'Linda',  'Taylor',  '703-111-0005');

INSERT INTO CLASS_AN (CLASS_CODE_AN, LEVEL_AN, COLOR_AN, DIRECTIONS_AN, TEACHER_ID_AN) VALUES
('F1', 'Fox',   'Blue',  'First floor, room 101', 1),
('F2', 'Fox',   'Green', 'First floor, room 102', 2),
('B1', 'Bear',  'Red',   'Second floor, room 201', 3),
('B2', 'Bear',  'Yellow','Second floor, room 202', 4),
('P1', 'Panda', 'Purple','Third floor, room 301', 5);

INSERT INTO STUDENT_AN (STUDENT_ID_AN, FIRST_NAME_AN, LAST_NAME_AN, DATE_OF_BIRTH_AN, ZIPCODE_AN, CLASS_CODE_AN) VALUES
(101, 'Ali',     'Huseyn',   '2018-04-15', '20169', 'F1'),
(102, 'Meryem',  'Nahmadli', '2017-09-10', '20169', 'F1'),
(103, 'Omar',    'Karim',    '2018-11-20', '20155', 'F2'),
(104, 'Layla',   'Rahim',    '2019-02-05', '20155', 'B1'),
(105, 'Sara',    'Ismayil',  '2017-12-30', '20169', 'P1');

INSERT INTO CARETAKER_AN (CARETaker_ID_AN, FIRST_NAME_AN, LAST_NAME_AN, WORK_PHONE_AN) VALUES
(201, 'Aysel',  'Huseyn',  '571-200-1001'),
(202, 'Kamran', 'Huseyn',  '571-200-1002'),
(203, 'Leyla',  'Nahmadli','571-200-1003'),
(204, 'Rashad', 'Karim',   '571-200-1004'),
(205, 'Ibrahim',  'Rahim',   '571-200-1005');

INSERT INTO ASSIGNMENT_AN (STUDENT_ID_AN, CARETAKER_ID_AN, RELATIONSHIP_AN) VALUES
(101, 201, 'mother'),
(101, 202, 'father'),
(102, 203, 'mother'),
(103, 204, 'father'),
(104, 205, 'mother'),
(105, 203, 'aunt');

SELECT * FROM TEACHER_AN;
SELECT * FROM CLASS_AN;
SELECT * FROM STUDENT_AN;
SELECT * FROM CARETAKER_AN;
SELECT * FROM ASSIGNMENT_AN;


SELECT
    CONCAT(S.FIRST_NAME_AN, ' ', S.LAST_NAME_AN)      AS Student,
    C.LEVEL_AN                                        AS Level,
    C.COLOR_AN                                        AS Color,
    C.DIRECTIONS_AN                                   AS Directions,
    CONCAT(T.FIRST_NAME_AN, ' ', T.LAST_NAME_AN)      AS Teacher
FROM STUDENT_AN  AS S
JOIN CLASS_AN    AS C ON S.CLASS_CODE_AN = C.CLASS_CODE_AN
JOIN TEACHER_AN  AS T ON C.TEACHER_ID_AN = T.TEACHER_ID_AN
ORDER BY Student;


SELECT
    C.COLOR_AN                                        AS Color,
    C.LEVEL_AN                                        AS Level,
    CONCAT(S.FIRST_NAME_AN, ' ', S.LAST_NAME_AN)      AS `Student Name`,
    S.ZIPCODE_AN                                      AS Zipcode
FROM CLASS_AN   AS C
JOIN STUDENT_AN AS S ON S.CLASS_CODE_AN = C.CLASS_CODE_AN
ORDER BY
    C.COLOR_AN,
    C.LEVEL_AN,
    `Student Name`;

SELECT
    CONCAT(CA.FIRST_NAME_AN, ' ', CA.LAST_NAME_AN)    AS Caretaker,
    CA.WORK_PHONE_AN                                  AS `Work Phone`,
    CONCAT(S.FIRST_NAME_AN, ' ', S.LAST_NAME_AN)      AS Student,
    CL.LEVEL_AN                                       AS Level,
    CL.COLOR_AN                                       AS Color
FROM CARETAKER_AN  AS CA
JOIN ASSIGNMENT_AN AS A  ON A.CARETAKER_ID_AN = CA.CARETaker_ID_AN
JOIN STUDENT_AN    AS S  ON A.STUDENT_ID_AN   = S.STUDENT_ID_AN
JOIN CLASS_AN      AS CL ON S.CLASS_CODE_AN   = CL.CLASS_CODE_AN
ORDER BY
    Caretaker,
    Student;

SELECT
    CONCAT(CA.FIRST_NAME_AN, ' ', CA.LAST_NAME_AN)    AS parent,
    CONCAT(T.FIRST_NAME_AN,  ' ', T.LAST_NAME_AN)     AS teacher,
    CONCAT(S.FIRST_NAME_AN,  ' ', S.LAST_NAME_AN)     AS student
FROM CARETAKER_AN  AS CA
JOIN ASSIGNMENT_AN AS A  ON A.CARETAKER_ID_AN = CA.CARETaker_ID_AN
JOIN STUDENT_AN    AS S  ON A.STUDENT_ID_AN   = S.STUDENT_ID_AN
JOIN CLASS_AN      AS CL ON S.CLASS_CODE_AN   = CL.CLASS_CODE_AN
JOIN TEACHER_AN    AS T  ON CL.TEACHER_ID_AN  = T.TEACHER_ID_AN
ORDER BY
    parent,
    teacher,
    student;
